### 关于mybatis自定义mapper位置

如果想mapper和mapper.xml 在同一个文件下，必须在pom.xml **build标签**中添加

```xml
<!-- 如果不添加此节点mybatis的mapper.xml文件都会被漏掉 无法添加到classes中 -->
        <resources>
            <resource>
                <directory>src/main/java</directory>
                <includes>
                    <include>**/*.xml</include>
                </includes>
                <filtering>true</filtering>
            </resource>
        </resources>
```

### springboot 集成Mybatis关于mysql批量操作

批量操作sql报错，需要在application.yml 数据库连接地址中配置 **allowMultiQueries=true**

​      

```yaml
#数据库连接地址
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver #mysql驱动
    url: jdbc:mysql://localhost:3306/test?serverTimezone=UTC&allowMultiQueries=true
```

MySQL连接数据库时，添加语句：“allowMultiQueries=true”的作用：
1.可以在sql语句后携带分号，实现多语句执行。
2.可以执行批处理，同时发出多个SQL语句。

### 关于项目中Lamda表达式的运用

不建议使用自定义接口lamda表达式： 对于接口的拓展有很大的限制，使用前须谨慎
对于java自带的则建议使用 如： list.forEeach() 

>对于声明了RandomAccessList（ArrayList有，LinkedList没有）来说，for稍高于iterator
>但是对于没有声明的，则iterator远远高于for

###  Stream的使用，批量添加，一次插入一万的数据量

**```java代码方面```**

```java
@SpringBootTest(classes = TestApplication.class)
@RunWith(SpringRunner.class)
public class TestDemo {
 
    @Autowired
    private TestMapper testMapper;
 
    @Test
    public void insert() {
        List<TestVO> list = new ArrayList<>();
        for (int i = 0; i < 200000; i++) {
            list.add(new TestVO());
        }
        int index = list.size() / 10000;
        for (int i=0;i< index;i++){
            //stream流表达式，skip表示跳过前i*10000条记录，limit表示读取当前流的前10000条记录
            testMapper.testBatchInsert(list.stream().skip(i*10000).limit(10000).collect(Collectors.toList()));
        }
    }
 
}
```

```mapper.xml方面```

**MySql写法**

```mysql
<!--MySql写法-->
<insert id="submitItem"  parameterType="java.util.List">
    insert into ITEM (
    ITEM_CODE,
    ITEM_NAME,
    ITEM_VALUE,
    ITEM_CATAGORY
    )
    values
    <foreach collection="list" item="item" index="index" separator="," >
      (
        #{item.itemCode,jdbcType=VARCHAR},
        #{item.itemName,jdbcType=VARCHAR},
        #{item.itemValue,jdbcType=VARCHAR},
        #{item.itemCategory,jdbcType=VARCHAR}
     )
    </foreach>
</insert>
```

**Oracle写法**

```sql

 1     <insert id="addList" parameterType="java.util.List" useGeneratedKeys="false">
 2         INSERT INTO T_APPLAUD
 3         (
 4             ID,
 5             USER_ID,
 6             BUSINESS_TYPE,
 7             PRODUCT_ID,
 8             CREATE_TIME
 9         )
10         <foreach item="item" index="index" collection="list" separator="union all">
11         (
12             SELECT 
13                 #{item.id},
14                 #{item.userId},
15                 #{item.businessType},
16                 #{item.productId},
17                 #{item.createdTime} 
18             FROM DUAL
19         )
20         </foreach>
21     </insert>
```

